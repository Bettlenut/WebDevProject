CREATE DATABASE IF NOT EXISTS db_webdev;

USE db_webdev;

CREATE TABLE IF NOT EXISTS tbl_accounts (
    id INT AUTO_INCREMENT PRIMARY KEY,
    firstname VARCHAR(50) NOT NULL,
    lastname VARCHAR(50) NOT NULL,
    contactnumber VARCHAR(20),
    address TEXT,
    email VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255),
    admin_privileges ENUM('yes', 'no') DEFAULT 'no',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS tbl_products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    productName VARCHAR(100) NOT NULL,
    productDescription TEXT NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    quantity INT NOT NULL,
    productImage VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS tbl_cart (
    cart_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NULL,
    product_id INT NOT NULL,
    quantity INT NOT NULL DEFAULT 1,
    date_added TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_cart_product
        FOREIGN KEY (product_id) REFERENCES tbl_products(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_cart_user
        FOREIGN KEY (user_id) REFERENCES tbl_accounts(id)
        ON DELETE CASCADE
);

INSERT INTO tbl_accounts (
    firstname,
    lastname,
    contactnumber,
    address,
    email,
    password,
    admin_privileges
) VALUES (
    'Admin',
    'User',
    '09171234567',
    '123 Admin St, Admin City',
    'admin@gmail.com',
    '$2y$10$Ad3hv5wXF4xKghkpYq8yFunA.nVqm.n2ycCSwzNwnKlYumhj.EHD6',
    'yes'
);
